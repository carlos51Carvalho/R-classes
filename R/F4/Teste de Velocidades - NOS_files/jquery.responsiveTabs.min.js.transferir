(function(n,t,i){function r(t,i){this.element=t;this.$element=n(t);this.tabs=[];this.state="";this.rotateInterval=0;this.$queue=n({});this.options=n.extend({},u,i);this.init()}var u={active:null,disabled:[],collapsible:"accordion",startCollapsed:!1,rotate:!1,setHash:!1,animation:"default",duration:500,activate:function(){},deactivate:function(){},load:function(){},activateState:function(){},classes:{stateDefault:"r-tabs-state-default",stateActive:"r-tabs-state-active",stateDisabled:"r-tabs-state-disabled",tab:"r-tabs-tab",anchor:"r-tabs-anchor",panel:"r-tabs-panel",accordionTitle:"r-tabs-accordion-title"}};r.prototype.init=function(){var i=this;this.tabs=this._loadElements();this._loadClasses();this._loadEvents();n(t).on("resize",function(n){i._setState(n)});n(t).on("hashchange",function(n){var r=i._getTabRefBySelector(t.location.hash),u=i._getTab(r);r>=0&&!u._ignoreHashChange&&!u.disabled&&i._openTab(n,i._getTab(r),!0)});this.options.rotate!==!1&&this.startRotation();this.$element.bind("tabs-activate",function(n){i.options.activate.call(this,n)});this.$element.bind("tabs-deactivate",function(n){i.options.deactivate.call(this,n)});this.$element.bind("tabs-load",function(n){var r=i._getTabRefBySelector(t.location.hash),u;i._setState(n);i.options.startCollapsed===!0||i.options.startCollapsed==="accordion"&&i.state==="accordion"||(u=r>=0&&!i._getTab(r).disabled?i._getTab(r):i.options.active>0&&!i._getTab(i.options.active).disabled?i._getTab(i.options.active):i._getTab(0),i._openTab(n,u),i.options.load.call(this,n,u))});this.$element.trigger("tabs-load")};r.prototype._loadElements=function(){var u=this,i=this.$element.children("ul"),r=[],t=0;return this.$element.addClass("r-tabs"),i.addClass("r-tabs-nav"),n("li",i).each(function(){var f=n(this),e=n("a",f),i=e.attr("href"),o=n(i),s=n("<div><\/div>").insertBefore(o),h=n("<a><\/a>").attr("href",i).html(e.html()).appendTo(s),c={_ignoreHashChange:!1,id:t,disabled:n.inArray(t,u.options.disabled)!==-1,tab:n(this),anchor:n("a",f),panel:o,selector:i,accordionTab:s,accordionAnchor:h,active:!1};t++;r.push(c)}),r};r.prototype._loadClasses=function(){for(var n=0;n<this.tabs.length;n++)this.tabs[n].tab.addClass(this.options.classes.stateDefault).addClass(this.options.classes.tab),this.tabs[n].anchor.addClass(this.options.classes.anchor),this.tabs[n].panel.addClass(this.options.classes.stateDefault).addClass(this.options.classes.panel),this.tabs[n].accordionTab.addClass(this.options.classes.accordionTitle),this.tabs[n].accordionAnchor.addClass(this.options.classes.anchor),this.tabs[n].disabled&&(this.tabs[n].tab.removeClass(this.options.classes.stateDefault).addClass(this.options.classes.stateDisabled),this.tabs[n].accordionTab.removeClass(this.options.classes.stateDefault).addClass(this.options.classes.stateDisabled))};r.prototype._loadEvents=function(){for(var n=this,r=function(i){var u=n._getCurrentTab(),r=i.data.tab;i.preventDefault();r.disabled||(n.options.setHash&&(t.location.hash=r.selector),i.data.tab._ignoreHashChange=!0,(u!==r||n._isCollapisble())&&(n._closeTab(i,u),u===r&&n._isCollapisble()||n._openTab(i,r,!1,!0)))},i=0;i<this.tabs.length;i++){this.tabs[i].anchor.on("click",{tab:n.tabs[i]},r);this.tabs[i].accordionAnchor.on("click",{tab:n.tabs[i]},r)}};r.prototype._setState=function(t){var r=n("ul",this.$element),i=this.state;this.state=r.is(":visible")?"tabs":"accordion";this.state!==i&&this.$element.trigger("tabs-activate-state",t,{oldState:i,newState:this.state})};r.prototype._openTab=function(n,t,i,r){var u=this;i&&this._closeTab(n,this._getCurrentTab());r&&this.rotateInterval>0&&this.stopRotation();t.active=!0;t.tab.removeClass(u.options.classes.stateDefault).addClass(u.options.classes.stateActive);t.accordionTab.removeClass(u.options.classes.stateDefault).addClass(u.options.classes.stateActive);u._doTransition(t.panel,u.options.animation,"open",function(){t.panel.removeClass(u.options.classes.stateDefault).addClass(u.options.classes.stateActive)});this.$element.trigger("tabs-activate",n,t)};r.prototype._closeTab=function(n,t){var r=this;t!==i&&(t.active=!1,t.tab.removeClass(r.options.classes.stateActive).addClass(r.options.classes.stateDefault),r._doTransition(t.panel,r.options.animation,"close",function(){t.accordionTab.removeClass(r.options.classes.stateActive).addClass(r.options.classes.stateDefault);t.panel.removeClass(r.options.classes.stateActive).addClass(r.options.classes.stateDefault)},!0),this.$element.trigger("tabs-deactivate",n,t))};r.prototype._doTransition=function(n,t,i,r,u){var f,e=this;switch(t){case"slide":f=i==="open"?"slideDown":"slideUp";break;case"fade":f=i==="open"?"fadeIn":"fadeOut";break;default:f=i==="open"?"show":"hide";e.options.duration=0}this.$queue.queue("responsive-tabs",function(u){n[f]({duration:e.options.duration,complete:function(){r.call(n,t,i);u()}})});(i==="open"||u)&&this.$queue.dequeue("responsive-tabs")};r.prototype._isCollapisble=function(){return typeof this.options.collapsible=="boolean"&&this.options.collapsible||typeof this.options.collapsible=="string"&&this.options.collapsible===this.getState()};r.prototype._getTab=function(n){return this.tabs[n]};r.prototype._getTabRefBySelector=function(n){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t].selector===n)return t;return-1};r.prototype._getCurrentTab=function(){return this._getTab(this._getCurrentTabRef())};r.prototype._getNextTabRef=function(n){var i=n||this._getCurrentTabRef(),t=i===this.tabs.length-1?0:i+1;return this._getTab(t).disabled?this._getNextTabRef(t):t};r.prototype._getPreviousTabRef=function(){return this._getCurrentTabRef()===0?this.tabs.length-1:this._getCurrentTabRef()-1};r.prototype._getCurrentTabRef=function(){for(var n=0;n<this.tabs.length;n++)if(this.tabs[n].active)return n;return-1};r.prototype.activate=function(n,t){var r=jQuery.Event("tabs-activate"),i=this._getTab(n);i.disabled||this._openTab(r,i,!0,t||!0)};r.prototype.getState=function(){return this.state};r.prototype.startRotation=function(t){var i=this;if(this.tabs.length>this.options.disabled.length)this.rotateInterval=setInterval(function(){var n=jQuery.Event("rotate");i._openTab(n,i._getTab(i._getNextTabRef()),!0)},t||(n.isNumeric(i.options.rotate)?i.options.rotate:4e3));else throw new Error("Rotation is not possible if all tabs are disabled");};r.prototype.stopRotation=function(){t.clearInterval(this.rotateInterval);this.rotateInterval=0};n.fn.responsiveTabs=function(t){var u=arguments;return t===i||typeof t=="object"?this.each(function(){n.data(this,"responsivetabs")||n.data(this,"responsivetabs",new r(this,t))}):typeof t=="string"&&t[0]!=="_"&&t!=="init"?this.each(function(){var i=n.data(this,"responsivetabs");i instanceof r&&typeof i[t]=="function"&&i[t].apply(i,Array.prototype.slice.call(u,1));t==="destroy"&&n.data(this,"responsivetabs",null)}):void 0}})(jQuery,window);