if(!window.Byside){window.Byside={}}if(!Byside.Utils){Byside.Utils={array2json:function(a){if(typeof window.JSON!="undefined"){return JSON.stringify(a)}var f=[];var b=(Object.prototype.toString.apply(a)==="[object Array]");for(var d in a){if(a.hasOwnProperty(d)){var e=a[d];if(typeof e=="object"){if(b){f.push(this.array2json(e))}else{f.push('"'+d+'":'+this.array2json(e))}}else{var g="";if(!b){g='"'+d+'":'}if(typeof e=="number"){g+=e}else{if(e===false){g+="false"}else{if(e===true){g+="true"}else{g+='"'+e+'"'}}}f.push(g)}}}var c=f.join(",");if(b){return"["+c+"]"}return"{"+c+"}"},remoteCallResultsLastId:0,remoteCallResults:[],remoteCallGenericCallback:function(b,a){this.remoteCallResults[b]=a},remoteCall:function(c,a,d,j){var e=false;var f=new Object();f.e=Byside.PageContext.getContext();f.m=c;f.p=a;if(d){f.a=d}if(j){f.c=(++this.remoteCallResultsLastId)}var b=bysideWebcare_get_agent_baseurl()+"rpc/handler.php?a="+encodeURIComponent(this.array2json(f))+"&rndc="+new Date().getTime();var h=document.getElementsByTagName("head")[0]||document.documentElement;var g=document.createElement("script");g.src=b;if(typeof window.bysideWebcare_cspid!=="undefined"&&window.bysideWebcare_cspid){g.setAttribute("nonce",bysideWebcare_cspid)}g.onload=g.onreadystatechange=function(){if(!e&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){e=true;g.onload=g.onreadystatechange=null;if(h&&g.parentNode){h.removeChild(g)}if(j&&typeof j==="function"){j(Byside.Utils.remoteCallResults[f.c])}}};h.insertBefore(g,h.firstChild)},decodeHtml:function decodeHtml(b){var a=document.createElement("textarea");a.innerHTML=b;return a.value},urlify:function urlify(b){var a=/(https?:\/\/[^\s]+)/g;b=Byside.Utils.decodeHtml(b);return b.replace(a,function(c){return'<a href="'+c+'" target="_blank">'+c+"</a>"})},}}if(!Byside.VisitorId){Byside.VisitorId={getToken:function(){var a=new Object();a.w=bysideWebcare_webcare_id;a.c=bysideWebcare_channel;a.f=encodeURIComponent(bysideWebcare_fid);a.t=byside_webcare_tuid;a.s=byside_webcare_suid;return a}}}if(!Byside.PageContext){Byside.PageContext={getContext:function(){var a=new Object();a.i=Byside.VisitorId.getToken();a.pu=byside_webcare_puid;a.r=encodeURIComponent(document.referrer);a.pg=encodeURIComponent(bysideWebcare_getcurrentpage());a.t=encodeURIComponent(bysideWebcare_getPageTitle());a.br=bysideWebcare_getBrowserResolution();a.re=screen.width+"x"+screen.height;a.l=bysideWebcare_lang;a.v=bysideWebcare_versionid;if(typeof window.bysideWebcare_cspid!=="undefined"&&window.bysideWebcare_cspid){a.n=window.bysideWebcare_cspid}return a}}}Byside.Contact={currentChatIsWriting:[],requestCall:function(e){var a={};e=e||{};a.ongoingClick2CallId=e.ongoingClick2CallId||0;this.requestClick2Call(e.phone||null,e.contactData||null,e.scheduleTime||null,e.windowId||null,e.requestOrigin||null,e.branchId||null,function b(k,j,h,l,g){if(typeof e.onSetup==="function"){g.suggested_status_msg=j;e.onSetup(g)}},function f(h,j,g){if(typeof e.onStatusChange==="function"){g.suggested_status_msg=j;e.onStatusChange(g)}},function c(){if(typeof e.onConnect==="function"){e.onConnect()}},function d(j,g,h){h.suggested_status_msg=g;if(typeof e.onHangup==="function"){e.onHangup(h)}},a)},requestClick2Call:function(e,l,d,j,a,b,g,k,f,h,c){c=c||{ongoingClick2CallId:0,};Byside.Utils.remoteCall("contact","requestClick2Call",{p:e,f:l,s:d,w:j,r:a,b:b,o:c.ongoingClick2CallId||0},function(m){Byside.Contact.currentChatIsWriting[m.callrequest_id]=false;g(m.status,m.status_msg,m.callrequest_id,m.custom_data,m);if(m.status==0&&(k||f||h)){var r=false;var q=false;var n;var o=setInterval(function(){Byside.Utils.remoteCall("contact","statusClick2Call",{c:m.callrequest_id},function(s){if(!r&&n!=s.state){n=s.state;if(s.state==20){r=true;clearInterval(o)}if(s.state){k(s.state,s.statemsg,s)}if(s.state==20&&h){h(s.hangupcause,s.hangupcausemsg,s)}if(!q&&(s.state==3||s.state==11||s.state==12||s.state==13)&&f){q=true;f()}}})},750)}})},requestChat:function(g){g=g||{};this.requestClick2Chat(g.contactData||null,g.windowId||null,g.requestOrigin||null,g.branchId||null,g.ongoingClick2ChatId||0,function b(l,k,m,n,j){if(typeof g.onSetup==="function"){j.suggested_status_msg=k;g.onSetup(j)}},function h(n,m,l,j,k){if(typeof g.onStatusChange==="function"){g.onStatusChange(k)}},function c(){if(typeof g.onConnect==="function"){g.onConnect()}},function d(){if(typeof g.onHangup==="function"){g.onHangup()}},function f(m,l,k,o,j){if(typeof g.onNewMessage==="function"){g.onNewMessage(j)}},function a(j){if(typeof g.onIsWritingChange==="function"){g.onIsWritingChange(j)}},function e(l,k,m,o,j){if(typeof g.onNewLink==="function"){g.onNewLink(j,k,m)}},g.initialMessage||"")},requestClick2Chat:function(n,l,b,d,e,j,m,g,k,h,c,f,a){Byside.Utils.remoteCall("contact","requestClick2Chat",{f:n,w:l,r:b,b:d,o:e,m:a||""},function(o){j(o.status,o.status_msg,o.chatrequest_id,o.custom_data,o);if(o.status==0&&(m||g||k)){var t=false;var s=false;var q;var r=setInterval(function(){Byside.Utils.remoteCall("contact","statusQueueClick2Chat",{c:o.chatrequest_id},function(v){if(!y&&q!=v.state){q=v.state;if(v.state=="f"){clearInterval(r);if(m){m(v.state,null,null,null,v)}}else{if(v.state=="e"){clearInterval(r);if(m){m(v.state,null,null,null,v)}}else{if(v.state=="c"){clearInterval(r);if(m){m(v.state,null,null,null,v)}if(!s&&g){s=true;g()}var x="";var u=-1;var y;var w=setInterval(function(){Byside.Utils.remoteCall("contact","statusOngoingClick2Chat",{c:o.chatrequest_id,l:u},function(C){var z=C.shard_num||"",A;if(!y){if(C.state=="f"){y=true;q="f";clearTimeout(w);if(m){m("f",null,null,null,v)}if(k){k()}return}if(C.lines&&C.lines.length>0){for(i=0;i<C.lines.length;i++){if(C.lines[i].n>u){u=C.lines[i].n;if(C.lines[i].d=="c"){var B=Byside.Utils.decodeHtml(C.lines[i].t||"");if(B.indexOf("fx:")==0){B=B.substring(3);p=B.lastIndexOf(".");if(p>0){A=B.substring(0,p)}if(f){f(C.lines[i].s,A,bysideWebcare_get_agent_baseurl()+"chat/ajax"+(z?"/"+z:"")+"/GetFile?chatrequest_id="+o.chatrequest_id+"&fx="+B+"&pid="+byside_webcare_tuid,C.lines[i].n,C.lines[i])}}else{if(B.indexOf("http://")==0||B.indexOf("https://")==0){f(C.lines[i].s,B,B,C.lines[i].n,C.lines[i])}}}else{if(C.lines[i].d!="p"){if(C.lines[i].t.indexOf("cbitem")===-1){C.lines[i].t=Byside.Utils.urlify(C.lines[i].t)}h(C.lines[i].d,C.lines[i].s,C.lines[i].t,C.lines[i].n,C.lines[i])}}}}}if(x!=C.is_writing){x=C.is_writing;if(c){c(x)}}}})},750)}else{if(v.state==" "){}else{if(v.state=="o"||v.state=="r"){if(m&&v.queue_position>0){m(v.state,v.queue_position,v.queue_time,v.queue_time_desc,v)}}}}}}}})},750)}})},sendClick2ChatMsg:function(a,b){Byside.Utils.remoteCall("contact","sendClick2ChatMsg",{c:a,t:b,e:0,})},endClick2Chat:function(b,a){Byside.Utils.remoteCall("contact","endClick2Chat",{c:b,s:a})},setClick2ChatIsWriting:function(a,b){if(Byside.Contact.currentChatIsWriting[a]!=b){Byside.Contact.currentChatIsWriting[a]=b;Byside.Utils.remoteCall("contact","setClick2ChatIsWriting",{c:a,i:(Byside.Contact.currentChatIsWriting[a]?1:0)})}},sendClick2ChatByEmail:function(b,a){Byside.Utils.remoteCall("contact","sendClick2ChatByEmail",{c:b,e:a})},getBranchAvailabilityStatus:function(a,b){Byside.Utils.remoteCall("contact","availabilityStatus",{b:a},b)},generateLeadAd:function(b,d,c,a){Byside.Utils.remoteCall("contact","generateLeadAd",{f:b,c:d,r:c},function(e){a(e.status,e.status_msg,e.answer_id,e.custom_data)})},setCustomerReview:function(e,d,c,a,b){Byside.Utils.remoteCall("contact","setCustomerReview",{c:e,i:d,r:c,a:a},function(f){if(typeof b==="function"){b(f||null)}})}};